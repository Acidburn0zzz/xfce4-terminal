#!/bin/sh
#
# $Id$
#
# Copyright (c) 2004 os-cillation e.K.
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
#

if test x"${BROWSER}" = x""; then
  for browser in mozilla firefox epiphany galeon mozilla opera konqueror; do
    if (which "${browser}") > /dev/null 2>&1; then
      BROWSER="${browser}"
      break;
    fi
  done
fi

if test x"${BROWSER}" = x""; then
  xmessage -center -file - -title Error <<EOF
TerminalHelp was unable to find a browser to use.
Please set the BROWSER environment variable.
EOF
  exit 1
fi

HELPDIR="@datadir@/doc/Terminal/"

if test -n "$LC_ALL"; then
  LC=$LC_ALL
elif test -n "$LANG"; then
  LC=$LANG
else
  LC="C"
fi

if test -n "$1"; then
  HELPFILE="$1.html"
else
  HELPFILE="index.html"
fi

if test -r "$HELPDIR/$LC/$HELPFILE"; then
  URL="$HELPDIR/$LC/$HELPFILE"
elif test -r "$HELPDIR/`echo $LC | sed 's/\(..\)_.*/\1/'`/$HELPFILE"; then
  URL="$HELPDIR/`echo $LC | sed 's/\(..\)_.*/\1/'`/$HELPFILE"
else 
  URL="$HELPDIR/C/index.html"
fi

[ -n "$2" ] && URL="$URL#$2"

case "$BROWSER" in
firefox*)
  $BROWSER -a firefox -remote openurl\("file://$URL",new-window\) || \
    $BROWSER "file://$URL"
  ;;
communicator*|netscape*|mozilla*|phoenix*|firebird*)
	$BROWSER -remote openurl\("file://$URL",new-window\) || \
		$BROWSER "file://$URL"
	;;
opera*)
	$BROWSER -remote openURL\("file://$URL",new-window\) || \
		$BROWSER "file://$URL"
	;;
*)
	$BROWSER "$URL"
	;;
esac

exit $?

# vim:set ts=2 sw=2 et ai:
